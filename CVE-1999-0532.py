#!/usr/bin/env python

###########################################
# Unrestricted DNS Zone Transfer Checker  #
#              CVE-1999-0532              #
#         Researcher: Joel A. Ossi        #
###########################################

import urllib2
import urllib
import time

f = open('domains.txt', 'r') # text file containing the URLS
for line in f:
    print("")
    print ('Checking: ' + line)
    dns = urllib2.urlopen("https://api.hackertarget.com/zonetransfer/?q=" + line).read()
    response = urllib.urlopen("https://api.hackertarget.com/zonetransfer/?q=" + line)
    time.sleep(1) # small interval to prevent WAF Blockade.
    checker = dns
    if checker.find("Transfer failed") == -1:
        print ("[!] VULNERABLE TARGET FOUND: " + line)
        with open('vulnerable.txt', 'a') as vulnerables:
            vulnerables.write(line + '\n')
    elif response.getcode() == 504:
        print('[-] Gateway Time-out Error' + '\n')
    else:
        print "[-] Transfer failed."
