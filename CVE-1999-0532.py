#!/usr/bin/env python

###########################################
# Unrestricted DNS Zone Transfer Checker  #
#              CVE-1999-0532              #
#         Researcher: Joel A. Ossi        #
###########################################

import urllib2
import time

f = open('domains.txt', 'r') # text file containing the URLS
for line in f:
    print("")
    print ('Checking: ' + line)
    try:
        dns = urllib2.urlopen("https://api.hackertarget.com/zonetransfer/?q=" + line).read()
        time.sleep(1) # small interval to prevent WAF Blockade.
        checker = dns
        if checker.find("Transfer failed") == -1:
            print ("[!] VULNERABLE TARGET FOUND: " + line)
            with open('vulnerable.txt', 'a') as vulnerables:
                vulnerables.write(line + '\n')
        elif checker.find("connection timed out; no servers could be reached") == -1:
            print('[-] Transfer Failed. Reason: DNS Server Connection Timed-Out')
        else:
            print "[-] Transfer failed. Reason: Denied"
    except urllib2.HTTPError, e:
        print ('[-] Transfer Failed, Reason: Error ' + str(e.code))
